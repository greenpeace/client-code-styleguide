/*
 * @name p3-styleguide
 * @version v0.3.0
 * @date 2014-04-23
 * @copyright Copyright (C) 2013, Greenpeace International
 * @source https://github.com/greenpeace/p3_styleguide*/
/* @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&dn=gpl-3.0.txt GPL-v3-or-Later */
"use strict";!function(a,b){var c=a.p3||(a.p3={}),d={delimiter:"|"};c.autofill=function(c,e){var f=a(c),g=a.extend(!0,d,e),h=b.location.href.split("#")[0];a.each(a.p3.request(h).parameters,function(b,c){if(c.indexOf(g.delimiter)>0){var d=a(':checkbox:nameNoCase("'+b+'")',f);a.each(c.split(g.delimiter),function(a,b){d.filter(':valueNoCase("'+b+'")').prop("checked",!0)})}else a(':radio:nameNoCase("'+b+'")',f).filter(':valueNoCase("'+c+'")').prop("checked",!0),a(':input:nameNoCase("'+b+'")',f).val(c),a(':input:selectNoCase("'+b+'")',f).val(c)})}}(jQuery,this),function(){function a(){}window.console||(window.console={});for(var b=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"],c=0;c<b.length;c++)window.console[b[c]]||(window.console[b[c]]=a)}(),function(a,b,c,d){var e=a.p3||(a.p3={}),f="$.p3.form_tracking :: ",g="undefined"==typeof b._gaq?[]:b._gaq;e.form_tracking=function(b){var e=a(b),h=e.is(":input")?e:a(":input",e),i=e.closest("form").attr("id")||c.title;g.length||console.warn(f+"Google Analytics not found"),h.blur(function(){var b=a(this),c=b.attr("name");c!==d&&g.push(h.val().length>0?["_trackEvent",i,"completed",c]:["_trackEvent",i,"skipped",c])})}}(jQuery,this,document),function(a,b){var c=a.p3||{};c.mobilesearchform=function(c){function d(b){var c;b.matches?(c=a("#main-nav .search-form").detach(),a(".heading-first .tools").append(c)):(c=a(".heading-first .tools .search-form").detach(),a("#nav").before(c))}c||(c=768);var e=parseInt(c,10);if("undefined"!=typeof b.matchMedia&&e){var f=b.matchMedia("(min-width: "+e+"px)");f.addListener(d),d(f)}},a.p3=c}(jQuery,this),function(a,b,c){var d=a.p3||{},e={el:"body",sizes:{threetwo:320,four:400,five:500,six:600,sixfive:650,seven:700,sevensome:768,eightfive:850,nine:900,tablet:480,desktop:1024,wide:1350,large:1600},onResize:!0,onLoad:!0,delay:100};d.narrow=function(d){function f(){return"number"==typeof b.innerWidth?b.innerWidth:c.documentElement&&c.documentElement.clientWidth?c.documentElement.clientWidth:void 0}function g(){var b="",c=f();a.each(i.sizes,function(a,d){c>=d?b+=" "+a:k.removeClass(a)}),k.addClass(b)}function h(a,b){l||(l=!0,setTimeout(function(){l=!1},b),a())}var i=a.extend(!0,e,d||{}),j=a(b),k=a(i.el),l=!1;i.onResize&&j.resize(function(){h(g,i.delay)}),i.onLoad&&j.ready(g)},a.p3=d}(jQuery,this,document),function(a,b,c,d){var e=a.p3||{},f={meterElement:".completed",meterWrapper:"#action-counter-graphical",countElement:".count",totalElement:".total",fetchFrequency:3e4,updateSpeed:25,initialAnimationTotalDuration:2500,dataElement:"body",dataNamespace:"pledgeData",externalTrigger:!0,fetchDataEvent:"pledgeCounterFetch",fetchCompleteEvent:"fetchPledgeDataComplete",jsonURL:"https://secured.greenpeace.org/international/en/api/v2/pledges/",params:{},timeout:3e4,abortOnError:!1};e.pledge_counter=function(e,g){var h=a.extend(!0,f,g||{}),i=a(h.meterElement,e),j=a(h.countElement,e),k=a(h.totalElement,e),l=!1,m=0,n=0,o={count:0,target:0},p=a.p3.request(h.jsonURL),q="$.p3.pledge_counter :: ",r=function(){if(l)return void setTimeout(function(){r()},h.fetchFrequency);l=!0;var a=o.count;m>a&&(m=0),n=Math.ceil(a*h.updateSpeed/h.initialAnimationTotalDuration,0),0>=n&&(n=1),j.text(t(o.count)),k.text(t(o.target)),s()},s=function(){if(m>=+o.count)return l=!1,void(h.externalTrigger||setTimeout(v,h.fetchFrequency));+(m+n)<+o.count?m+=+n:m=+o.count;var a=m/o.target*100;a>100&&(a=100),b.csstransforms?i.css({width:a+"%"}).html(t(m)+"&nbsp;"):i.animate({width:a+"%"},h.updateSpeed-5>=0?h.updateSpeed:0,function(){i.html(t(m)+"&nbsp;")}),setTimeout(s,h.updateSpeed)},t=function(a){for(var b=a+"",c=b.split("."),d=c[0],e=c.length>1?"."+c[1]:"",f=/(\d+)(\d{3})/;f.test(d);)d=d.replace(f,"$1,$2");return d+e},u=function(){var b=a(h.dataElement).data(h.dataNamespace);if(b&&"error"!==b.status&&b.pledges[0].action){if(o.count=b.pledges[0].action.count,o.target=b.pledges[0].action.target,isNaN(o.count)||isNaN(o.target))return console.warn(q+"Progress data not found or not valid, attempting to continue"),!1;a(h.meterWrapper).show(),r()}else if(h.abortOnError)throw new Error(q+"Errors in pledge data:",b)},v=function(){var b=a.extend(!0,p.parameters,h.params);a.support.cors=!0,a.ajax({url:p.url,timeout:h.timeout,dataType:"json",data:b}).success(function(b){a(h.dataElement).data(h.dataNamespace,b)}).fail(function(a){var b=q+'Failed to load "'+p.url+'"';if(h.abortOnError)throw new Error(b,a);console.warn(b,a)}).always(function(){a.event.trigger(h.fetchCompleteEvent)})};b.load({test:c.JSON,nope:["dist/js/compat/json.min.js"],complete:function(){b.csstransforms&&i.css({"transition-duration":h.updateSpeed+"ms"}),a(d).on(h.fetchDataEvent,function(){v()}),a(d).on(h.fetchCompleteEvent,function(){u()}),h.externalTrigger===!1&&a.event.trigger(h.fetchDataEvent)}})},a.p3=e}(jQuery,Modernizr,this,document),function(a,b,c,d){var e=a.p3||{},f={emailField:"#UserEmail",identifyUserBy:"email",registrationFields:"#action-form-register",exceptionFields:"#action-form-message, #action-smallprints",signerCheckURL:"https://secured.greenpeace.org/international/en/api/v2/pledges/signercheck/",validateForm:!0,validationRulesURL:"https://secured.greenpeace.org/international/en/api/v2/pledges/validation/",animationDuration:350,disableOnError:!1,params:{},showSummary:!1,messageElement:'<div class="message"></div>',debug:!1};a.expr[":"].p3_empty=function(b){var c=a(b);return c.attr("name")===d?!1:""===c.val()},e.pledge_with_email_only=function(g,h){var i,j,k,l=a.extend(!0,f,h||{}),m=a(g),n=a(l.emailField),o=[],p=a.p3.request(l.signerCheckURL),q="$.p3.pledge_with_email_only :: ",r={url:p.url,parameters:a.extend(!0,p.parameters,l.params)},s=function(){if(r.parameters.page===d&&r.parameters.action===d)throw new Error(q+"Page or Action identifier not found")},t=function(){switch(l.identifyUserBy){case"email":r.parameters.user=n.val();break;case"uuid":throw new Error(q+"uuid not implemented");default:throw new Error(q+"config.identifyUserBy: "+l.identifyUserBy+" invalid")}return r.parameters.user},u=function(){r.parameters.expire===d&&console.warn(q+"No expiry date set")},v=function(){j.prop("disabled",!0).addClass("disabled").prop("value","Please wait...")},w=function(){j.removeClass("disabled").removeProp("disabled").prop("value",k)},x=function(b){var c=a.Deferred();return o[b]={checked:!1,valid:!1},a.getJSON(r.url,r.parameters,function(d){if(o[b].checked=!0,"success"===d.status)o[b].valid=!0,c.resolve();else{switch(d.error.code){case 1:throw new Error(q+"Invalid Key");case 2:case 3:case 4:case 5:throw console.error(d.error),new Error(q+"Invalid parameters: ",r.parameters);case 13:var e=n.parents(".email:first"),f=a(".message",e);f.length||(e.append(l.messageElement),f=a(".message",e)),o[b].valid=!1,f.append('<span class="error" for="'+n.attr("id")+'">'+d.error.message+"</span>"),n.addClass("error");break;case 15:a(".first-time",i).show(l.animationDuration),o[b].valid=!0,B();break;case 16:o[b].valid=!0,a(".first-time",i).html("<p>Welcome back!<br/>We just need a little more information for this pledge</p>").show(l.animationDuration),z(d.user);break;default:console.warn("Unhandled error code: "+d.error.code,d.error),o[b].checked=!1}c.reject()}}).fail(function(){if(l.disableOnError)throw new Error("$.p3.pledge_with_email_only.js :: Signer API request failed");console.warn(q+"Failed to load JSON, all form inputs re-enabled"),B(),j.removeClass("disabled"),c.reject()}),c.promise()},y=function(a){a&&l.debug&&console.log(q+a),i.submit()},z=function(b){a.each(b,function(b,c){var d=a('div:classNoCase("'+b+'")',i),e=a(":input",d);e.length?c===!1?(e.removeProp("disabled"),d.show(l.animationDuration)):(e.prop("disabled",!0),e[0].disabled=!0):console.warn(q+""+b+" not found")})},A=function(){a(l.registrationFields+" > :not("+l.exceptionFields+", #action-submit-full)").hide().find(":input").removeClass("error").prop("disabled","disabled")},B=function(){a(l.registrationFields+" > :not("+l.exceptionFields+", #action-submit-full)").show(l.animationDuration).find(":input").removeProp("disabled")},C=function(){A(),s(),u(),j.click(function(b){if(j.hasClass("disabled"))return console.log(q+"Submit is disabled"),!1;v();var c=t();return c?void(o[c]&&o[c].checked?(o[c].valid?y(q+"Resubmit valid email address"):setTimeout(function(){n.parent().find(".error").show(l.animationDuration)},l.animationDuration),w()):(b.preventDefault(),A(),n.valid()?a.when(x(c)).then(function(){y("Can submit via email only, pledging ...")},function(){w()}):(y(q+"Doesn't look like a valid email address"),w()))):(console.warn(q+"No email specified"),A(),y(),w(),!1)}),l.validateForm&&a.p3.validation(i,{jsonURL:l.validationRulesURL,params:r.parameters,debug:!0,showSummary:l.showSummary,disableOnError:l.disableOnError}),a(":input[type!=submit]",i).keypress(function(b){if(13===b.which){var c=a(this);return c.is("textarea")?!0:(b.preventDefault(),j.focus().click(),!1)}})};if(i=m.is("form")?m:a("form",g).length?a("form",g):a("form").first(),!i)throw new Error(q+"form not found");j=a("input[type=submit][value!=search]",i),k=j.prop("value"),b.load({test:c.JSON,nope:["js/compat/json.min.js"],complete:C}),a.p3=e}}(jQuery,Modernizr,this),function(a,b,c,d){var e=a.p3||{},f={jsonURL:"https://secured.greenpeace.org/international/en/api/v2/pledges/",params:{},mangleTime:!0,timeSelector:".since",timeDataAttr:"data-since",countrySelector:"#UserCountry",countryJSON:"json/countries/countries_en.json",externalTrigger:!1,dataElement:"body",dataNamespace:"pledgeData",fetchDataEvent:"recentSignersFetch",fetchCompleteEvent:"fetchPledgeDataComplete",updateInterval:3e4,userQueueInterval:750,maxUsers:5,maxRefreshes:30,timeout:3e4,abortOnError:!1};a.timeago.settings.strings={prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"%d seconds",minute:"a minute",minutes:"%d minutes",hour:"an hour",hours:"%d hours",day:"a day",days:"%d days",month:"a month",months:"%d months",year:"a year",years:"%d years",wordSeparator:" ",numbers:[]},e.recent_signers=function(e,g){var h=a.extend(!0,f,g),i=a(e),j=!1,k=a.p3.request(h.jsonURL),l=[],m=[],n=!1,o=0,p="$.p3.recent_signers :: ",q={running:!1,delay:h.userQueueInterval,actions:[],step:function(){if(q.actions.length)try{q.actions.pop()()}catch(a){console.error(a)}else q.running=!1},run:function(){q.running=!0,q.actions.length?(q.step(),setTimeout(q.run,q.delay)):q.running=!1}},r=function(){if(q.running)return clearTimeout(n),n=setTimeout(function(){r()},h.updateInterval),!1;var b=a.extend(!0,k.parameters,h.params);a.support.cors=!0,a.ajax({url:k.url,timeout:h.timeout,dataType:"json",data:b}).success(function(b){a(h.dataElement).data(h.dataNamespace,b)}).fail(function(a){var b=p+'Failed to load "'+k.url+'"';if(h.abortOnError)throw new Error(b,a)}).always(function(){a.event.trigger(h.fetchCompleteEvent)})},s=function(){var b=a(h.dataElement).data(h.dataNamespace);if(!h.externalTrigger&&o++<h.maxRefreshes&&q.actions.push(function(){clearTimeout(n),n=setTimeout(function(){a.event.trigger(h.fetchDataEvent)},h.updateInterval)}),!b||"error"===b.status){if(h.abortOnError)throw new Error(p+"JSON data invalid");return void q.run()}a.each(b.pledges,function(a,b){return l[b.user.id]?!1:(l[b.user.id]=!0,b.user.dont_display_name===!0?(console.warn(p+"pledge.user.dont_display_name is true"),!0):void q.actions.push(function(){w(b)}))}),q.actions.push(function(){x()}),q.run()},t=function(b){if(b){var c=a.trim(b);return h.mangleTime&&c.match(/\s/)&&(c=c.replace(/\s/,"T")+"Z"),a.timeago(c)}},u=function(){var b=a.Deferred(),c=0;if(h.countrySelector){if(a.each(a(h.countrySelector+" option"),function(b,d){var e=a(d),f=e.val();f&&(m[f.toUpperCase()]=e.text(),c++)}),c>0)return b.resolve(),b.promise();if(console.warn(p+"No countries found in "+h.countrySelector),h.abortOnError)return b.reject("Aborting",m),b.promise()}return h.countryJSON&&a.ajax({url:h.countryJSON,timeout:h.timeout,dataType:"json"}).success(function(a){m=a,b.resolve()}).fail(function(a){b.reject("Error fetching JSON from "+h.countryJSON,a)}),b.promise()},v=function(a){var b=m.hasOwnProperty(a.toUpperCase())?m[a.toUpperCase()]:!1;return b?b:(console.error(p+"Country not found for code "+a),a)},w=function(b){var c=b.user,d=b.created,e=t(d),f=c.country,g=v(c.country),i=c.firstname||"",k=c.lastname||"",l=a('<li style="display:none"> </li>');l.append('<span class="since" data-since="'+d+'">'+e+"</span>").append('<span class="icon flag '+f+'"></span>').append('<span class="name">'+i+" "+k+"</span>").append(' <span class="country">'+g+"</span>"),j.prepend(l),l.show(350),h.maxUsers&&a("li",j).length>h.maxUsers&&a("li:last",j).hide(350,function(){this.remove()})},x=function(){a(h.timeSelector,j).each(function(){var b=a(this);b.text(t(b.attr(h.timeDataAttr)))})};h.updateInterval<5e3&&(h.updateInterval=5e3),j=a("ul:first",i),j.length||(j=a("<ul></ul>"),i.append(j)),b.load({test:c.JSON,nope:["js/compat/json.min.js"],complete:function(){var b=u();b.done(function(){x(),a(d).on(h.fetchDataEvent,function(){r()}),a(d).on(h.fetchCompleteEvent,function(){s()}),h.externalTrigger||a.event.trigger(h.fetchDataEvent)}),b.fail(function(a,b){console.error(a,b)})}})},a.p3=e}(jQuery,Modernizr,this,document),function(a,b){var c=a.p3||{},d={rememberMeSelector:"#RememberMe",emailSelector:"#UserEmail",cookieName:"email",expires:31,secure:"https"===window.location.protocol||"https"===document.location.protocol?!0:!1,keepRememberMeState:!0};c.remember_me_cookie=function(c,e){var f=a.extend(!0,d,e||{}),g=a(c).is("form")?a(c):a("form:first",c),h=a(f.rememberMeSelector,g).first(),i=a(f.emailSelector,g).first(),j=f.keepRememberMeState&&b.localstorage?!0:!1;a.cookie.defaults={expires:f.expires,secure:f.secure},i.val(a.cookie(f.cookieName)),g.submit(function(){h.is(":checked")?a.cookie(f.cookieName,i.val()):a.removeCookie(f.cookieName),j&&(localStorage.rememberMeGP=h.is(":checked")?"true":"false")}),j&&"undefined"!==localStorage.rememberMeGP&&h.prop("checked","true"===localStorage.rememberMeGP?!0:!1)},a.p3=c}(jQuery,Modernizr),function(a){var b=a.p3||{};b.request=function(a){var b={url:!1,parameters:!1},c=[],d=function(){var a={};return c[1]&&c[1].split(/[&;]/g).forEach(function(b){var c=b.split(/\=/);c.length>1&&c[0].length&&c[1].length&&(a[c[0]]=c[1])}),a},e=function(){return c[0].length?c[0]:a};return a?(c=a.split("?"),b.url=e(),b.parameters=d(),b):b},a.p3=b}(jQuery),function(a){a.expr[":"].classNoCase=function(b,c,d){var e=a(b).attr("class"),f=d[3];return f&&e?e.toUpperCase().indexOf(f.toUpperCase())>=0:!1},a.expr[":"].nameNoCase=function(b,c,d){var e=a(b).attr("name"),f=d[3];return f&&e?e.toUpperCase().indexOf(f.toUpperCase())>=0:!1},a.expr[":"].selectNoCase=function(b,c,d){var e=a("option",b).val()||"",f=d[3];return f&&e.length?e.toUpperCase().indexOf(f.toUpperCase())>=0:!1},a.expr[":"].valueNoCase=function(b,c,d){var e=a(b).val()||"",f=d[3];return f&&e.length?e.toUpperCase().indexOf(f.toUpperCase())>=0:!1}}(jQuery),function(a,b,c){var d=a.p3||{},e=" :: $.p3.social_sharing :: ",f={pageURL:!1,popup:{top:200,left:100,width:650,height:380},networks:{facebook:{enabled:!0,url:"http://www.facebook.com/sharer.php?u=__REFERRER__",count:0},twitter:{enabled:!0,url:"https://twitter.com/intent/tweet?original_referer=__REFERRER__&source=tweetbutton&text=__TITLE__&url=__REFERRER__&via=__ACCOUNT__",count:0,title:!1,account:"greenpeace"},google:{enabled:!0,url:"https://plus.google.com/share?url=__REFERRER__",count:0},linkedin:{enabled:!0,url:"https://www.linkedin.com/cws/share?url=__REFERRER__&original_referer=__REFERRER__",count:0},pinterest:{enabled:!0,url:"http://pinterest.com/pin/create/button/?url=__REFERRER__&media=__IMAGE__&description=__DESCRIPTION__",count:0,image:!1,description:!1}},precision:1,api:"https://www.greenpeace.org/api/p3/pledge/social.json"};d.social_sharing=function(d,g){function h(a){for(var b=a+"",c=b.split("."),d=c[0],e=c.length>1&&1*c[1]>0&&100>a?"."+c[1].replace(/0+$/,""):"",f=/(\d+)(\d{3})/;f.test(d);)d=d.replace(f,"$1,$2");return d+e}function i(a){if(a=1*a,1e4>a)return h(a);for(var b=["","K","M","G","T","P","E"],c=a,d=0;c>1e3;)c/=1e3,d++;return h(1*c.toFixed(k.precision))+b[d]}function j(){k.pageURL===!1&&(console.warn(e+'page referrer URL is not set, using "'+c.location.href+'"'),k.pageURL=c.location.href),a.each(k.networks,function(b,d){if(d.enabled!==!1){var f=a("a."+b,l),g=a("span",f.prev())||!1,h=d.url;switch(b){case"pinterest":d.image===!1&&(console.warn(e+"Pinterest sharing requires an image."),d.image=""),d.description===!1&&(console.warn(e+"Pinterest sharing requires a description."),d.description=document.title),h=h.replace("__IMAGE__",encodeURIComponent(d.image)),h=h.replace("__DESCRIPTION__",encodeURIComponent(d.description));break;case"twitter":d.title===!1&&(console.warn(e+"Twitter sharing requires a title."),d.title=document.title),h=h.replace("__TITLE__",encodeURIComponent(d.title)),h=h.replace("__ACCOUNT__",encodeURIComponent(d.account))}h=h.replace(/__REFERRER__/g,encodeURIComponent(k.pageURL)),f.attr({href:h,target:"_blank"}).click(function(a){a.preventDefault(),c.open(h,"Share this page","left="+k.popup.left+",top="+k.popup.top+",width="+k.popup.width+",height="+k.popup.height+",toolbar=0,resizable=1")}),g&&g.text(i(d.count))}})}var k=a.extend(!0,f,g||{}),l=a(d);k.api?b.load({test:c.JSON,nope:["dist/js/compat/json.min.js"],complete:function(){a.getJSON(k.api,function(b){if(a.extend(!0,k,b),"success"!==b.status)throw console.warn(b),new Error(e+"Status: "+b.status+": server reported a problem");j()}).fail(function(){throw new Error(e+'Failed to load JSON: "'+k.api+'"')})}}):j()},a.p3=d}(jQuery,Modernizr,this),function(a,b,c){var d=a.p3||{},e={jsonURL:"https://www.greenpeace.org/api/p3/pledges",rules:{},tests:{alphaPlus:"^[\\p{L}\\p{N}\\.\\-\\'\\,\\’\\s\\/]+$",numeric:"^\\p{N}+$",alpha:"^\\p{L}+$",url:"^((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\\+\\$,\\w]+@)[A-Za-z0-9.-]+)((?:\\/[\\+~%\\/.\\w-_]*)?\\??(?:[-\\+=&;%@.\\w_]*)#?(?:[\\w]*))?)$"},autoSign:!1,onfocusout:!1,onkeyup:!1,showSummary:!1,summarySelector:".errorSummary",summaryElement:'<div class="errorSummary message"></div>',disableOnError:!1,errorElement:"span",errorPlacement:function(b,c){var d=a(c),e=d.prop("name").toUpperCase();d.parents(":classNoCase("+e+")").find("div.message").html(b)},params:{},animationDuration:250,messageElement:'<div class="message"></div>'};a.validator.addMethod("valueNotEquals",function(a,b,c){return c!==a},"Value must not equal arg."),d.validation=function(d,f){var g,h=a.extend(!0,e,f||{}),i=a.p3.request(h.jsonURL),j={url:i.url,parameters:a.extend(!0,i.parameters,h.params)},k=a.p3.request(c.location.href).parameters,l=a(d),m=h.messageElement,n="$.p3.validation.js :: ",o=function(){a(":input",g).removeProp("disabled").removeClass("disabled")},p=function(){a(":input",g).prop("disabled","disabled").addClass("disabled")},q=function(){if(h.disableOnError&&p(),h.showSummary){a(h.summarySelector,l).length||l.prepend(h.summaryElement);var b=a(h.summarySelector).first();h.errorPlacement=function(){},h.invalidHandler=function(a,c){var d,e=c.numberOfInvalids();d=1===e?"Oops, there was a problem on 1 field.<br/>It has been highlighted below":"Oops, there was a problem on "+e+" fields.<br/>They have been highlighted below",setTimeout(function(){b.html('<span class="error">'+d+"</span>"),b.show(h.animationDuration)},100)},a(":input[type=submit]",g).on("click",function(){b.hide().html("")})}a.each(h.tests,function(b,c){try{a.validator.addMethod(b,function(a,b){var d=new XRegExp(c,"i");return this.optional(b)||d.test(a)})}catch(d){console.warn(n+"Failed to add test '"+b+"' with regex '"+c+"'"),console.warn(d)}}),a(":input",g).each(function(){var b=a(this),c=b.prop("name"),d=c?b.parents(":classNoCase("+c+")").first():!1;d?d.find("div.message").length||d.append(m):b.is("[type=submit]")||console.warn(n+'"'+c+'" field parent not found')}),o(),g.validate(h),(h.autoSign||"true"===k.auto_sign||"1"===k.auto_sign)&&(a.p3.pledge_with_email_only?a("input[type=submit][value!=search]",g).click():g.submit())};if(g=l.is("form")?l:a("form",d).length?a("form",d):a("form").first(),!g)throw new Error(n+"form not found");j.url?b.load({test:c.JSON,nope:["js/compat/json.min.js"],complete:function(){a.support.cors=!0,a.getJSON(j.url,j.parameters,function(b){h=a.extend(!0,h,b)}).fail(function(){if(console.warn(n+"JSON failed to load from: "+h.jsonURL),h.disableOnError)throw p(),new Error(n+"Form input disabled");console.warn(n+"Attempting to continuing regardless...")}).complete(function(){q()})}}):q()},a.p3=d}(jQuery,Modernizr,this);
/* @license-end */